{
  "type": "record",
  "name": "OrderRecord",
  "fields": [
    { "name": "order_id", "type": ["null", "string"] },
    { "name": "customer_id", "type": ["null", "string"] },
    { "name": "order_date", "type": ["null", "string"] },
    { "name": "shipping_date", "type": ["null", "string"] },
    { "name": "delivery_date", "type": ["null", "string"] },
    { "name": "order_status", "type": ["null", "string"] },
    { "name": "payment_method", "type": ["null", "string"] },
    { "name": "currency", "type": ["null", "string"] },
    { "name": "total_amount", "type": ["null", "int"] },
    { "name": "discount", "type": ["null", "int"] },
    { "name": "tax", "type": ["null", "int"] },
    { "name": "shipping_cost", "type": ["null", "int"] },
    { "name": "product_id", "type": ["null", "string"] },
    { "name": "product_name", "type": ["null", "string"] },
    { "name": "product_category", "type": ["null", "string"] },
    { "name": "product_subcategory", "type": ["null", "string"] },
    { "name": "quantity", "type": ["null", "int"] },
    { "name": "unit_price", "type": ["null", "int"] },
    { "name": "vendor_id", "type": ["null", "string"] },
    { "name": "vendor_name", "type": ["null", "string"] },
    { "name": "warehouse_id", "type": ["null", "string"] },
    { "name": "warehouse_location", "type": ["null", "string"] },
    { "name": "region", "type": ["null", "string"] },
    { "name": "sales_channel", "type": ["null", "string"] },
    { "name": "order_priority", "type": ["null", "string"] },
    { "name": "referral_source", "type": ["null", "string"] },
    { "name": "device_type", "type": ["null", "string"] },
    { "name": "browser", "type": ["null", "string"] },
    { "name": "ip_address", "type": ["null", "string"] },
    { "name": "shipping_address", "type": ["null", "string"] },
    { "name": "billing_address", "type": ["null", "string"] },
    { "name": "customer_feedback", "type": ["null", "string"] },
    { "name": "customer_rating", "type": ["null", "int"] },
    { "name": "return_requested", "type": ["null", "boolean"] },
    { "name": "return_reason", "type": ["null", "string"] },
    { "name": "refund_amount", "type": ["null", "int"] },
    { "name": "loyalty_points_used", "type": ["null", "int"] },
    { "name": "gift_wrap", "type": ["null", "boolean"] },
    { "name": "special_instructions", "type": ["null", "string"] },
    { "name": "promotion_code", "type": ["null", "string"] },
    { "name": "shipment_tracking_number", "type": ["null", "string"] },
    { "name": "shipment_carrier", "type": ["null", "string"] },
    { "name": "expected_delivery_date", "type": ["null", "string"] },
    { "name": "actual_delivery_date", "type": ["null", "string"] },
    { "name": "order_review_date", "type": ["null", "string"] },
    { "name": "customer_service_interaction", "type": ["null", "string"] },
    { "name": "order_revision", "type": ["null", "int"] },
    { "name": "is_fraudulent", "type": ["null", "boolean"] }
  ]
}


from pyspark.sql.types import StructType, StructField, StringType, IntegerType, BooleanType

customOrderSchema = StructType([
    StructField("order_id", StringType(), True),
    StructField("customer_id", StringType(), True),
    StructField("order_date", StringType(), True),
    StructField("shipping_date", StringType(), True),
    StructField("delivery_date", StringType(), True),
    StructField("order_status", StringType(), True),
    StructField("payment_method", StringType(), True),
    StructField("currency", StringType(), True),
    StructField("total_amount", IntegerType(), True),
    StructField("discount", IntegerType(), True),
    StructField("tax", IntegerType(), True),
    StructField("shipping_cost", IntegerType(), True),
    StructField("product_id", StringType(), True),
    StructField("product_name", StringType(), True),
    StructField("product_category", StringType(), True),
    StructField("product_subcategory", StringType(), True),
    StructField("quantity", IntegerType(), True),
    StructField("unit_price", IntegerType(), True),
    StructField("vendor_id", StringType(), True),
    StructField("vendor_name", StringType(), True),
    StructField("warehouse_id", StringType(), True),
    StructField("warehouse_location", StringType(), True),
    StructField("region", StringType(), True),
    StructField("sales_channel", StringType(), True),
    StructField("order_priority", StringType(), True),
    StructField("referral_source", StringType(), True),
    StructField("device_type", StringType(), True),
    StructField("browser", StringType(), True),
    StructField("ip_address", StringType(), True),
    StructField("shipping_address", StringType(), True),
    StructField("billing_address", StringType(), True),
    StructField("customer_feedback", StringType(), True),
    StructField("customer_rating", IntegerType(), True),
    StructField("return_requested", BooleanType(), True),
    StructField("return_reason", StringType(), True),
    StructField("refund_amount", IntegerType(), True),
    StructField("loyalty_points_used", IntegerType(), True),
    StructField("gift_wrap", BooleanType(), True),
    StructField("special_instructions", StringType(), True),
    StructField("promotion_code", StringType(), True),
    StructField("shipment_tracking_number", StringType(), True),
    StructField("shipment_carrier", StringType(), True),
    StructField("expected_delivery_date", StringType(), True),
    StructField("actual_delivery_date", StringType(), True),
    StructField("order_review_date", StringType(), True),
    StructField("customer_service_interaction", StringType(), True),
    StructField("order_revision", IntegerType(), True),
    StructField("is_fraudulent", BooleanType(), True)
])
