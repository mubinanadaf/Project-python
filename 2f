def test_dependency_chain(self):
    get = self.dag.get_task
    ids = {t.task_id for t in self.dag.tasks}

    run = get("run_time_variables")
    pre = get("dimc_pre_check")

    wdis = get("data_load_write_disposition") if "data_load_write_disposition" in ids else None
    load = (
        get("data_load_task") if "data_load_task" in ids
        else get("data_load_bq_bq")
    )
    post = get("dimc_post_check") if "dimc_post_check" in ids else None

    # run -> pre
    self.assertIn("dimc_pre_check", run.downstream_task_ids)
    self.assertIn("run_time_variables", pre.upstream_task_ids)

    if wdis:  # pre -> write_disposition -> load
        self.assertIn("data_load_write_disposition", pre.downstream_task_ids)
        self.assertIn("dimc_pre_check", wdis.upstream_task_ids)

        self.assertIn(load.task_id, wdis.downstream_task_ids)
        self.assertIn("data_load_write_disposition", load.upstream_task_ids)
    else:     # pre -> load (direct)
        self.assertIn(load.task_id, pre.downstream_task_ids)
        self.assertIn("dimc_pre_check", load.upstream_task_ids)

    if post:  # load -> post (only if present)
        self.assertIn("dimc_post_check", load.downstream_task_ids)
        self.assertIn(load.task_id, post.upstream_task_ids)
