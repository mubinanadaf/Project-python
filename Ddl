CREATE TABLE IF NOT EXISTS demo.customer_history (
  customer_id     INT64 NOT NULL,   -- Natural/business key
  name            STRING,           -- Customer name
  email           STRING,           -- Customer email
  address         STRING,           -- Customer address
  effective_from  DATE NOT NULL,    -- Start date for this version
  effective_to    DATE NOT NULL,    -- End date for this version (9999-12-31 for current)
  is_current      BOOL NOT NULL     -- Flag to mark active record
)
PARTITION BY DATE(effective_from)   -- Efficient queries by load date
CLUSTER BY customer_id;             -- Improves lookups by customer_id
